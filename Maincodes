package org.example.controller;

import org.example.model.MergedEntity;
import org.example.service.MergedEntityService;
import org.example.util.CsvExportUtil;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@RestController
@RequestMapping("/api/csv")
public class CsvExportController {

    @Autowired
    private MergedEntityService mergedEntityService; // Service to fetch merged entities

    /**
     * Export merged entities to CSV.
     * Example usage: GET http://localhost:8080/api/csv/export?filePath=C:/new/merged_output.csv
     */
    @GetMapping("/export")
    public String exportMergedDataToCsv(@RequestParam String filePath) {
        List<MergedEntity> mergedEntities = mergedEntityService.getAllMergedEntities();
        CsvExportUtil.exportToCsv(mergedEntities, filePath);
        return "CSV exported successfully to: " + filePath;
    }
}
