package org.example.controllem; // ✅ Make sure this package is correct

import org.example.model.MergedEntity;
import org.example.service.DataService;
import org.example.util.CsvExportUtil;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

import java.util.List;

@RestController
public class DataController {

    private final DataService dataService;

    // ✅ Constructor Injection
    public DataController(DataService dataService) {
        this.dataService = dataService;
    }

    // ✅ This endpoint will trigger CSV export
    @GetMapping("/export")
    public String getAllMergedEntities() {
        List<MergedEntity> mergedEntities = dataService.getMergedEntities();

        // ✅ Make sure this path exists on your machine
        CsvExportUtil.exportToCsv(mergedEntities, "C:/output/merged_report.csv");

        return "CSV exported successfully to C:/output/merged_report.csv";
    }
}
